Migration document:

Part: core
From version: 1.3
To version: 1.4


Execute the following steps below in the given order:


Name: Rename numberTable to lowercase and rename disallowed fields 
Goal: The cmsc uses a modified storage definition which forces lowercase table names
Type: sql-script
--- Start script ---
RENAME TABLE mm_numberTable TO mm_numbertable;
ALTER TABLE mm_archive CHANGE column date m_date datetime;
ALTER TABLE mm_attachments CHANGE column size m_size int(11);
ALTER TABLE mm_editwizards CHANGE column constraints m_constraints varchar(255);
ALTER TABLE mm_nodeparameter CHANGE column value m_value int(11);
ALTER TABLE mm_portletparameter CHANGE column value m_value varchar(255);
ALTER TABLE mm_properties CHANGE column value m_value varchar(255);
ALTER TABLE mm_properties CHANGE column module m_module varchar(255);
ALTER TABLE mm_rssfeed CHANGE column language m_language text;
ALTER TABLE mm_site CHANGE column language m_language varchar(2);
ALTER TABLE mm_syncnodes CHANGE column timestamp m_timestamp int(11);
ALTER TABLE mm_typerel CHANGE column max m_max int(11);
ALTER TABLE mm_user CHANGE column language m_language varchar(2);

ALTER TABLE mm_publishqueue CHANGE column timestamp m_timestamp datetime;
ALTER TABLE mm_publishqueue CHANGE column action m_action varchar(32);
ALTER TABLE mm_remotenodes CHANGE column timestamp m_timestamp datetime;


RENAME TABLE live_numberTable TO live_numbertable;
ALTER TABLE live_archive CHANGE column date m_date datetime;
ALTER TABLE live_attachments CHANGE column size m_size int(11);
ALTER TABLE live_editwizards CHANGE column constraints m_constraints varchar(255);
ALTER TABLE live_nodeparameter CHANGE column value m_value int(11);
ALTER TABLE live_portletparameter CHANGE column value m_value varchar(255);
ALTER TABLE live_properties CHANGE column value m_value varchar(255);
ALTER TABLE live_properties CHANGE column module m_module varchar(255);
ALTER TABLE live_rssfeed CHANGE column language m_language text;
ALTER TABLE live_site CHANGE column language m_language varchar(2);
ALTER TABLE live_syncnodes CHANGE column timestamp m_timestamp int(11);
ALTER TABLE live_typerel CHANGE column max m_max int(11);
ALTER TABLE live_user CHANGE column language m_language varchar(2);

ALTER TABLE live_publishqueue CHANGE column timestamp m_timestamp datetime;
ALTER TABLE live_publishqueue CHANGE column action m_action varchar(32);
ALTER TABLE live_remotenodes CHANGE column timestamp m_timestamp datetime;

--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*

Name: Checksum field for binary content 
Goal: Add a checksum field to attachments and images
Type:  sql-script
--- Start script ---
ALTER TABLE mm_images ADD column checksum varchar(255) default NULL;
ALTER TABLE mm_attachments ADD column checksum varchar(255) default NULL;

ALTER TABLE live_images ADD column checksum varchar(255) default NULL;
ALTER TABLE live_attachments ADD column checksum varchar(255) default NULL;
--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*



Name: JSPs inside customer projects may have wrong taglib-uri
Goal: replace old uri-s with new correct uri-s
Wrong found taglibs e.g.:
<%@ taglib uri="http://finalist.com/csmc" prefix="cmsc"%>
<%@ taglib uri="http://finalist.com/csmc-basicmodel" prefix="cmsc-bm"%>

Good taglibs:
<%@ taglib uri="http://finalist.com/cmsc" prefix="cmsc"%>
<%@ taglib uri="http://finalist.com/cmsc-basicmodel" prefix="cmsc-bm"%> 
With the focus on: cmsc instead of csmc!
